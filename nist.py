#Libraries needed 
import requests
import json

#Start Script

class nvd_database:

	def cve_checking(self):
		#Input CVE Number: I.E CVE-2021-35361
		cveId = input("Input CVE: ")

		# This URL is from the National Vulnerability Database
		nvd_url = "https://services.nvd.nist.gov/rest/json/cve/1.0/" + cveId
		#API Parameters
		parameters = {'cveId': cveId}
		headers = {
		'Content-Type': 'application/json'
		}

		#Get API Response and response code
		response = requests.get(nvd_url)
		print(response)

		#Results are in JSON but we store it first for final print
		json_beautify = json.dumps(response.json(), indent=4)
		print(json_beautify)


		# Beautify and save JSON results
		with open('nvd_nist.json', 'w') as json_file:
			json.dump(response.json(), json_file, sort_keys = True, indent = 4,
				ensure_ascii = False)

#Initiate Class
nvd_database_init = nvd_database()
nvd_database_init.cve_checking()